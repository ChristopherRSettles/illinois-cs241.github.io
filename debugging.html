<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="images/favicons/manifest.json">
  <link rel="mask-icon" href="images/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">

  <title>Debugging Guide</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link async rel="stylesheet" href="/css/code-style.css?v=2018-03-15 14:21:15 +0000">
  <link rel="stylesheet" href="/css/main.css?v=2018-03-15 14:21:15 +0000">

</head>

<body>
<!-- Always shows a header, even in smaller screens. -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">

            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand navbar-link normal" href="/">CS 241: System Programming</a>
            <a class="navbar-brand navbar-link small" href="/">CS 241</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li>
            <a class="navbar-link" href="/mps.html">MPs</a>
            </li>
            <li>
            <a class="navbar-link" href="/labs.html">Labs</a>
            </li>
            <li>
            <a class="navbar-link" href="/help.html">Help!</a>
            </li>
            <li>
            <a class="navbar-link" href="/schedule.html">Schedule</a>
            </li>
            <li>
            <a class="navbar-link" href="/honors.html">Honors</a>
            </li>
            <li>
            <a class="navbar-link" href="/staff.html">The Crew</a>
            </li>
            <li>
            <a class="navbar-link" href="/search.html">Search</a>
            </li>
            <li>
            <a class="navbar-link" href="/wikibook/home.html">Wikibook</a>
            </li>
          </ul>
        </div>
        </div>
</nav>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-sm-1 col-xs-0"></div>
    <div class="col-md-8 col-sm-10 col-xs-12">
      <div class="wrapper">
        <div class="pad"><div class="card">
          <div class="title">
            <div class="speaker-wrapper">
              <button onclick="speak()" class="speaker" alt="Read Page"></button>
            </div>
            <h1>
              Debugging Guide
              
            </h1>
          </div>
          <div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
            
          </div></div></div>
        </div></div>
      </div>
      <div class="toc-wrapper">
<h4>Content</h4>
<ul class="toc">
<li><a id="toc_svn" href="#svn" class="fancy-link">SVN</a></li>
<li><a id="toc_viewing-grade-report" href="#viewing-grade-report" class="fancy-link">Viewing grade report</a></li>
<li><a id="toc_make-commands" href="#make-commands" class="fancy-link">Make Commands</a></li>
<li><a id="toc_starting-to-debug---valgrind" href="#starting-to-debug---valgrind" class="fancy-link">Starting to debug - Valgrind</a></li>
<li><a id="toc_gdb" href="#gdb" class="fancy-link">GDB</a></li>
</ul>
</div>
      <div id="content">
        
        <div class="wrapper">
  <div class="pad"><div class="card">
<div class="title"><h2 id="learning-objectives" class="title-text">Learning Objectives<a class="anchor title-text" href="#learning-objectives">#</a>
</h2></div>
  
  


<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>
    The learning objectives for Debugging Guide are: <br>
    </p>
<ul class="mdl-list">
      
        <li class="mdl-list__item">
          <span class="mdl-list__item-primary-content">Learning how to debug 241 Code</span>
        </li>
      
    </ul>
</div></div></div>
</div></div>
</div>
        <div class="wrapper">
<div class="pad"><div class="card">
<div class="title"><h2 id="svn" class="title-text">SVN<a class="anchor title-text" href="#svn">#</a>
</h2></div>













<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>The autograder has given you bad test cases! First let’s step through this.</p>
<p>This is an example log given when you run <code class="highlighter-rouge">svn log</code></p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> svn log
<span class="go">------------------------------------------------------------------------
r52475 | bvenkat2 | 2016-10-16 22:23:09 -0500 (Sun, 16 Oct 2016) | 1 line

Oh sh-
------------------------------------------------------------------------
r52470 | cs241svngrader | 2016-10-16 22:21:15 -0500 (Sun, 16 Oct 2016) | 1 line

know_your_tools autograde at revision {2016-10-20} at time 2016-10-16 22:20:55.866453
------------------------------------------------------------------------
r50338 | bvenkat2 | 2016-10-13 01:05:29 -0500 (Thu, 13 Oct 2016) | 1 line

know your tools deploy
------------------------------------------------------------------------
</span></code></pre></div></div>
<p><strong>You don’t need to do this for this lab</strong></p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> svn revert <span class="nt">-r52470</span> <span class="c">#Or whatever revision number</span>
</code></pre></div></div>
<p>Now we should be at a good stage, we know what is going wrong. What this did is take your repository all the way back to the time when the autograder ran the code. <strong>If on later assignments you have done work after this, you should ideally not do this because it loses the changes after the autograder commit</strong>. In order to check what code ran in this case, you can follow the below instructions.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="viewing-grade-report" class="title-text">Viewing grade report<a class="anchor title-text" href="#viewing-grade-report">#</a>
</h2></div>







<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p><img src="./images/grade_report.png" alt="Sample Grade Report"></p>
<ol>
  <li>Overall Score - Gives you your grade on the assignment</li>
  <li>Grade Report History - All your past autogrades</li>
  <li>Timestamp - When we ran the autograder</li>
  <li>Revision Number - The revision number that we autograded. This is a link that takes you to your code at autograde revision</li>
  <li>Test Cases - Test cases! Click the test cases for more information on why you failed that test case. If you passed, it will may also give you successful output.</li>
</ol>
<p><strong>Remember, before asking about an autograde, check the revision that we autograded</strong></p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="make-commands" class="title-text">Make Commands<a class="anchor title-text" href="#make-commands">#</a>
</h2></div>



















<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<h3 id="make" class="title-text">Make</h3>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">make
</span></code></pre></div></div>
<p>Will make all of the targets, or all the assignments.</p>
<h3 id="make-clean" class="title-text">Make clean</h3>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">make clean
</span></code></pre></div></div>
<p>to make sure there aren’t any leftover object files. This will force recompilation of all the files as well</p>
<h3 id="make-debug" class="title-text">Make Debug</h3>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">make debug
</span></code></pre></div></div>
<p>To generate a debug build. A debug build has things like variable names and line numbers which are super helpful for debugging. It will generate a file with <code class="highlighter-rouge">executable_name-debug</code>. When we get to multithreading assignments you can <code class="highlighter-rouge">make tsan</code> in order to get thread sanitization as well.</p>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="starting-to-debug---valgrind" class="title-text">Starting to debug - Valgrind<a class="anchor title-text" href="#starting-to-debug---valgrind">#</a>
</h2></div>























<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>To test for memory errors, try</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> valgrind ./secure_move-debug files/final.txt files/final_test.txt
</code></pre></div></div>
<p>Valgrind will give you helpful output like the line number and stack trace where a memory error occured as well as where that memory was allocated.</p>
<p>Using the test cases that you failed, design a test that would make the code fail and run valgrind on it to see where the error is.</p>
<p>The most likely options you will need to know for valgrind</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> valgrind <span class="nt">--leak-check</span><span class="o">=</span>full ...
</code></pre></div></div>
<p>Which will check for leaks from all process/possible leaks and anything in between.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> valgrind <span class="nt">--leak-check</span><span class="o">=</span>full <span class="nt">--show-leak-kinds</span><span class="o">=</span>all ...
</code></pre></div></div>
<p>This will trace anything still reachable at the end of the program and report if you’re cleanup method didn’t clean everything up.</p>
<p>More about valgrind is below.</p>
<ul>
  <li><a href="http://valgrind.org/docs/manual/QuickStart.html" class="fancy-link wiki-link">Valgrind</a></li>
</ul>
</div></div></div>
</div></div>
<div class="pad"><div class="card">
<div class="title"><h2 id="gdb" class="title-text">GDB<a class="anchor title-text" href="#gdb">#</a>
</h2></div>





























<div class="container-fluid"><div class="row"><div class="content col-sm-11 .col-sm-offset-1">
<p>In this course, you will need to know how to use GDB</p>
<p>Consider the simple program (you may be able to spot the bug already)</p>
<pre><code class="language-C"><a class="code-copy" rel="code-copy-0" onclick="onCopy(this);">Copy</a><span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">double</span> <span class="n">convert_to_radians</span><span class="p">(</span><span class="kt">int</span> <span class="n">deg</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">deg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">deg</span> <span class="o">&lt;</span> <span class="mi">360</span><span class="p">;</span> <span class="o">++</span><span class="n">deg</span><span class="p">){</span>
		<span class="kt">double</span> <span class="n">radians</span> <span class="o">=</span> <span class="n">convert_to_radians</span><span class="p">(</span><span class="n">deg</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%d. %f</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">radians</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">convert_to_radians</span><span class="p">(</span><span class="kt">int</span> <span class="n">deg</span><span class="p">){</span>
	<span class="k">return</span> <span class="p">(</span> <span class="mi">31415</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span> <span class="o">*</span> <span class="n">deg</span> <span class="o">/</span> <span class="mi">180</span><span class="p">;</span>
<span class="p">}</span>
<textarea id="code-copy-0" class="code-copy-textarea" value='#include &amp;lt;stdio.h&amp;gt;

double convert_to_radians(int deg);

int main(){
	for(int deg = 0; deg &amp;lt; 360; ++deg){
		double radians = convert_to_radians(deg);
		printf("%d. %f\n", deg, radians);
	}
	return 0;
}

double convert_to_radians(int deg){
	return ( 31415 / 1000 ) * deg / 180;
}
'></textarea></code></pre>
<p>Let’s say that we have a problem with our program. How can we use gdb to debug? First we ought to load GDB.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> gdb <span class="nt">--args</span> ./main
<span class="gp">(gdb) layout src;</span> <span class="c">#if you want an GUI type</span>
<span class="go">(gdb) run
(gdb)
</span></code></pre></div></div>
<p>Hey that doesn’t look right.</p>
<p>Want to take a look at the source?</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">(gdb) l
</span><span class="gp">1	#</span>include &lt;stdio.h&gt;
<span class="go">2	
</span><span class="gp">3	double convert_to_radians(int deg);</span>
<span class="go">4	
5	int main(){
</span><span class="gp">6		for(int deg = 0;</span> deg &lt; 360<span class="p">;</span> ++deg<span class="o">){</span>
<span class="gp">7			double radians = convert_to_radians(deg);</span>
<span class="gp">8			printf("%d. %f\n", deg, radians);</span>
<span class="go">9		}
</span><span class="gp">10	    return 0;</span>
<span class="gp">(gdb) break 7 #</span> <span class="nb">break</span> &lt;file&gt;:line or <span class="nb">break</span> &lt;file&gt;:function
<span class="go">(gdb) run
(gdb)
</span></code></pre></div></div>
<p>Huh the breakpoint didn’t even trigger, meaning the code never got to that point. That’s because of the comparison! Okay flip the sign it should work now right?</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">(gdb) run
350. 60.000000
351. 60.000000
352. 60.000000
353. 60.000000
354. 60.000000
355. 61.000000
356. 61.000000
357. 61.000000
358. 61.000000
359. 61.000000
</span></code></pre></div></div>
<p>Well doesn’t look like it. Let’s see what is wrong.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">(gdb) break 14 if deg == 359 #</span> Let<span class="s1">'s check the last iteration only
</span><span class="go">(gdb) run
</span><span class="c">...
</span><span class="gp">(gdb) print/x deg #</span> print the hex value of degree
<span class="gp">$</span>1 <span class="o">=</span> 0x167
<span class="go">(gdb) print (31415/1000)
</span><span class="gp">$</span>2 <span class="o">=</span> 0x31
<span class="go">(gdb) print (31415/1000.0)
</span><span class="gp">$</span>3 <span class="o">=</span> 201.749
<span class="go">(gdb) print (31415.0/10000.0)
</span><span class="gp">$</span>4 <span class="o">=</span> 3.1414999999999999
</code></pre></div></div>
<p>It looks like we make a casting error as well! We can change it and our program is fixed!</p>
<p>These are just the most basic things that you can do with the tools. We highly recommend that you read tutorials on these tools to effectively use them through out this course. Here are just a couple of promising links:</p>
<ul>
  <li><a href="https://www.youtube.com/watch?v=PorfLSr3DDI" class="fancy-link wiki-link">CppCon 2015: Greg Law “Give me 15 minutes &amp; I’ll change your view of GDB”</a></li>
  <li><a href="https://www.cs.umd.edu/~srhuang/teaching/cmsc212/gdb-tutorial-handout.pdf" class="fancy-link wiki-link">GDB</a></li>
</ul>
</div></div></div>
</div></div>
</div>
        
        <div class="wrapper">
</div>
      </div>
      <div class="col-md-2 col-sm-1 col-xs-0"></div>
    </div>
  </div>
  <script>
    var github_repo = "illinois-cs241/illinois-cs241.github.io";
    var github_path = "_tutorials/debugging.md";
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha384-xBuQ/xzmlsLoJpyjoggmTEz8OWUFM0/RC5BsqQBDX2v5cMvDHcMakNTNrHIW2I5f" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-Ra6zh6uYMmH5ydwCqqMoykyf1T/+ZcnOQfFPhDrp2kI4OIxadnhsvvA2vv9A7xYv" crossorigin="anonymous"></script>
<script src="/js/main.js?v=2018-03-15 14:21:15 +0000"></script>

<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover({
      trigger: 'manual',
        container: $(this).attr('id'),
        placement: 'top',
        content: function () {
            return '<div class="hover-hovercard"></div>';
        }
    }).on("mouseenter", function () {
        var _this = this;
        $(this).popover("show");
        $(this).siblings(".popover").on("mouseleave", function () {
            $(_this).popover('hide');
        });
    }).on("mouseleave", function () {
        var _this = this;
        setTimeout(function () {
            if (!$(".popover:hover").length) {
               $(_this).popover("hide")
            }
        }, 100);
    });

    $('[data-toggle="tooltip"]').tooltip();
});

</script>
<script src="/js/analytics.js"></script>
<footer class="">

<div class="container-fluid">
<div class="shadow"></div>

</div>

</footer>

</body>
</html>
